## 1. Обзор

HTTP (англ. _Hypertext Transfer Protocol_) — прикладной протокол семейства TCP/IP, используемый для передачи произвольных данных. Передача HTTP-сообщений организована посредством TCP — протокола транспортного уровня, по умолчанию используется порт 80. Последней актуальной версией протокола является [HTTP/2](https://tools.ietf.org/html/rfc7540).

HTTP базируется на сетевой архитектуре «клиент-сервер». Как правило, в качестве клиента выступает браузер, в качестве сервера — хостинг с развернутым веб-сайтом. Клиент отправляет HTTP-сообщение с запросом серверу, а сервер, который предоставляет _ресурсы_, возвращает ответное HTTP-сообщение клиенту.

_Ресурс_ представляет из себя файл (например, HTML-страницу) или что-то абстрактное (например, услугу по некоторой обработке информации). Чтобы указать на необходимый ему ресурс, клиент в HTTP-запросе указывает [URI](https://ru.wikipedia.org/wiki/URI) (англ. _Uniform Resource Identifiers_).

## 2. Формат сообщений

В общем случае структура HTTP-сообщения имеет следующий вид:

1) **стартовая строка** (англ. _start line_) указывает на ресурс и операцию над ним;

2) **заголовки** (англ. _headers_) определяют параметры передачи и характеризуют тело сообщения;

3) пустая строка;

4) **тело сообщения** (англ. _message body_) — данные, которые необходимо передать.

### 2.1. Стартовая строка

Как видно из таблицы, стартовые строки отличаются для запроса и ответа:

| № | 1 | 2 | 3 |
|---|---|---|---|
| Формат с.с. запроса | METHOD | URI | HTTP/Version |
| Пояснение             | Метод. Операция, которую необходимо выполнить над ресурсом. | Идентифицирует ресурс. | Версия используемого протокола. Всегда добавляется к сообщению, начиная с версии 1.0. |
| Формат с.с. ответа | HTTP/Version | STATUS CODE | REASON |
| Пояснение | Аналогично сообщению запроса. | Код состояния — это трехзначное целое число. Указывает на состояние запроса. | Текстовое пояснение от сервера о состоянии запроса. Необязательное поле. |

### 2.1.1. Методы

Спецификацией HTTP [определены 9 методов](https://tools.ietf.org/html/rfc7231#section-4). По соглашению эти методы определяются заглавными ASCII-символами. Кроме того, допускается реализация собственных методов. При этом все методы регистрозависимы. Наиболее частоиспользуемые методы — это:

* GET — используется, чтобы запросить указанный URI ресурс;
* HEAD — аналогичен GET за исключением того, что ответ сервера не будет содержать тело. Используется для извлечения информации о доступности ресурса, дате его изменения, а также прочей информации о нём.
* POST — просит сервер принять тело запроса в качестве ресурса с указанным URI.

Все серверы обязаны поддерживать методы GET и HEAD, все остальные методы опциональны.

### 2.1.2. Коды состояния

Также спецификацией [определено](https://tools.ietf.org/html/rfc7231#section-8.2) множество кодов состояния. В зависимости от кода состояния клиент определяет, какие действия ему необходимо предпринять. Первая цифра кода указывает на класс ответа: 1xx — _информационный_ (не содержит тело), 2xx — _успех_, 3xx — _перенаправление_, 4xx — _ошибка клиента_, 5xx — _ошибка сервера_.

### 2.2. Заголовки

Заголовки, по своей сути, уточняют контекст запросов и ответов, а синтаксически выглядят как пара имя и значение, разделенные двоеточием. В отличие от наименований методов, к регистру не чувствительны. Примеры некоторых стандартных заголовков:

* _Content-Type_ — позволяет определить формат и способ обработки тела сообщения;
* _Content-Encoding_ — указывает на кодировку тела сообщения;
* _Content-Length_ — указывает на длину тела в байтах;
* _Accept-Ranges_ — в ответе сервера указывает на возможность запрашивать фрагменты ресурса, указывая их смещения от начала файла в байтах;
* _Range_ — используется для получения фрагмента ресурса: в сообщении указывается запрашиваемый диапазон байт. GET-запрос, в котором присутствует заголовок Range, называют частичным.
* _If-Modified-Since_ — значение данного заголовка содержит дату. Сервер присылает ресурс в ответ на запрос только в том случае, если ресурс изменился после указанной даты. GET-запрос, если в него включен данный заголовок, называют условным.
* _ETag_ — данный заголовок содержит идентификатор определенной версии ресурса. Наряду с _If-Modified-Since_ может использоваться для актуализации кэшированных данных.

## 3. HTTP-сессии и cookie

Группу последовательно отправленных сообщений «запрос-ответ» называют HTTP-сессией. HTTP является протоколом без сохранения состояния: это означает, что сервер не обязан сохранять информацию о том, какие запросы выполнял клиент ранее в течение сессии. Тем не менее, существует механизм, который позволяет сохранять персональные настройки, аутентифицировать пользователя и отслеживать период действия его авторизации — куки (англ. _cookie_). Куки представляют собой небольшой фрагмент данных, отправляемых с сервером и сохраняемых браузером для дальнейшего использования. При дальнейших посещениях сервера браузер пересылает этот фрагмент данных обратно.